---
title: Coco-AI × Amazon S3：秒搜你的云端文件
tags: Coco-AI
toc: true
categories: 极限科技
date: 2025-08-10 00:00:00
---

随着企业和个人数据量的激增，如何高效管理与搜索云端资料，成为提升工作效率的关键。
**Coco-AI** 新增的 **S3 对象存储连接器**，可以将 **Amazon S3** 存储桶直接接入智能检索系统，实现秒级搜索、即时访问，让云端文件像本地文档一样触手可及。

本篇将详细介绍如何通过 **Docker 快速部署 Coco Server**，并配置 S3 连接器，完成与亚马逊云科技的无缝集成。

### 一、快速部署 Coco Server

Coco Server 是连接器功能的运行核心，部署好它后才能接入 S3。
生产环境建议使用持久化存储方式，避免数据丢失。

**推荐部署方式（生产环境）**
持久化存储，避免数据丢失：

```bash
docker run -d \
  --name cocoserver \
  -p 9000:9000 \
  -v data:/app/easysearch/data \
  -v config:/app/easysearch/config \
  -v logs:/app/easysearch/logs \
  infinilabs/coco:0.7.1-2426
```

<!-- more -->

**测试部署方式（非持久化）**

```bash
docker run -d \
  --name cocoserver \
  -p 9000:9000 \
  infinilabs/coco:0.7.1-2426
```

> 建议生产环境使用第一种部署方式，测试环境可选择第二种。

---

### 二、配置 AI 模型

创建用户后，我选择 **Ollama** 作为模型提供商：

- 地址：`http://localhost:11434`
- 模型：`deepseek-r1:7b`

![设置模型](https://raw.githubusercontent.com/cloudsmithy/picgo-imh/master/35d9bf40d93482edcfd1cac26bd0f557.png)

在「模型提供商」界面可以看到默认开启的 **Coco AI**，它会直接调用我配置的 Ollama，也支持其他兼容 OpenAI API 的 LLM。

![模型提供商](https://raw.githubusercontent.com/cloudsmithy/picgo-imh/master/b84c85218a471729a646fc47bc899838.png)
![Coco AI 设置](https://raw.githubusercontent.com/cloudsmithy/picgo-imh/master/b86711e540165b68ad9f77f5c9f7e4c7.png)

---

### 三、数据源概览

Coco-AI 默认内置官方文档和 Hacker News 数据源，近期新增三类连接器：

![数据源连接器](https://raw.githubusercontent.com/cloudsmithy/picgo-imh/master/45419dc868e753402576504aedb4be6f.png)

- **S3 连接器**（本篇重点）
- 本地文件连接器
- RSS 连接器

![8cab32aeab3b966b11d0370372982415](https://raw.githubusercontent.com/cloudsmithy/picgo-imh/master/8cab32aeab3b966b11d0370372982415.png)

---

### 四、接入 Amazon S3

1. **选择 S3 对象存储连接器**
   填写 **Endpoint**（例：东京区 `s3.ap-northeast-1.amazonaws.com`）、**Bucket 名称**、**亚马逊云科技凭证（Access Key ID / Secret Access Key）**，刷新间隔建议保持 **1 分钟** 默认值。

   ![3cb586e73f22d92740ae9ca8589a5548](https://raw.githubusercontent.com/cloudsmithy/picgo-imh/master/3cb586e73f22d92740ae9ca8589a5548.png)

2. **获取亚马逊云科技访问凭证**

   - 登录 **亚马逊云科技 IAM 控制台**
   - 创建访问密钥（Access Key ID / Secret Access Key）
   - 为用户分配最小化 S3 访问权限（推荐遵循最小权限原则）

   ![image-20250810113853491](https://raw.githubusercontent.com/cloudsmithy/picgo-imh/master/image-20250810113853491.png)

   这里选择访问密钥 - 创建访问密钥，然后保存 Access Key ID / Secret Access Key 就好。
   ![ae3c5becf8fbf554e94a2624e422ecd1](https://raw.githubusercontent.com/cloudsmithy/picgo-imh/master/ae3c5becf8fbf554e94a2624e422ecd1.png)

创建过程中会出现最佳实践提示，不影响后续配置，下载密钥即可使用。
其他的凭证方式虽然有 IAM Role 和 Role anywhere，但是我们这次不会用到。

![41be05e14aefb28c33a9b6cf6b6c360a](https://raw.githubusercontent.com/cloudsmithy/picgo-imh/master/41be05e14aefb28c33a9b6cf6b6c360a.png)

确保这个用户有访问 S3 的权限，如果是生产的环境的话，确保要采用最小权限原则来防止不必要的麻烦。如果你在存储桶上配置了对应桶策略也可以。

![0092335804bdbbc32e1a86523b714ceb](https://raw.githubusercontent.com/cloudsmithy/picgo-imh/master/0092335804bdbbc32e1a86523b714ceb.png)

3. **对象前缀（Prefix）配置**
   这个是我在 S3 上的对象存储，放了一些 markdown 文件上去。
   还是这张图，我使用的是东京区的存储桶 dify233，所以 endpoint 是 s3.ap-northeast-1.amazonaws.com。

![3cb586e73f22d92740ae9ca8589a5548](https://raw.githubusercontent.com/cloudsmithy/picgo-imh/master/3cb586e73f22d92740ae9ca8589a5548.png)

这里的对象前缀可以理解为目录，在 S3 设置之初会把所有文件夹的名称当作前缀加到文件名前面，所以也有 S3 是扁平化管理一说。

![image-20250810115049644](https://raw.githubusercontent.com/cloudsmithy/picgo-imh/master/image-20250810115049644.png)

---

### 五、集成效果

完成连接后，S3 中的 Markdown 文件可被 Coco-AI **实时索引与检索**，点击搜索结果即可跳转到 S3 公网访问链接，例如：

```
https://<bucket>.s3.<region>.amazonaws.com/<对象名>
```

不仅支持标题关键词搜索，还可结合 LLM 实现**语义检索**，极大提升信息获取效率。

![连接器列表](https://raw.githubusercontent.com/cloudsmithy/picgo-imh/master/1d685c561ee0ea233fcf8f92846d5c99.png)

添加完成后可以看到我同时接入了 S3、本地文件和 RSS，我们这里主要开介绍关于 S3 的连接器。
![Coco App 数据源](https://raw.githubusercontent.com/cloudsmithy/picgo-imh/master/facdce6af59da887be3227b663e2eae9.png)

使用 Coco-AI 搜索时，能快速检索到 s3 中的 markdown 文件。
![c00fba85122f676609f20966c8c2ac37](https://raw.githubusercontent.com/cloudsmithy/picgo-imh/master/c00fba85122f676609f20966c8c2ac37.png)

点击搜索结果可直接跳转到对应链接。
![994789ee413cc311f518d78e8d457e00](https://raw.githubusercontent.com/cloudsmithy/picgo-imh/master/994789ee413cc311f518d78e8d457e00.png)

也支持把地址复制出来：https://dify233.s3.ap-northeast-1.amazonaws.com/对象名，其实就是S3的https 链接了。

![image-20250810115839596](https://raw.githubusercontent.com/cloudsmithy/picgo-imh/master/image-20250810115839596.png)

### 六、适用场景

- **企业内部知识库**：研发文档、政策文件、培训资料统一存放于 S3
- **个人云端资料管理**：博客、项目资料随时调用
- **跨团队协作**：多地访问，实时共享

通过 **Coco-AI S3 连接器**，只需几步，即可让 ** Amazon S3** 成为高效智能检索系统的云端引擎。
无论是个人开发者，还是大型企业团队，都能快速构建**跨云端、本地、第三方数据源的统一知识平台**。
