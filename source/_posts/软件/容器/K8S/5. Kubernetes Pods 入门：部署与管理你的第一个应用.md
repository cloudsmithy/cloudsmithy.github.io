### Kubernetes Pods 入门：部署与管理你的第一个应用

在 Kubernetes 中，**Pod** 是最基本的部署单元。每个 Pod 都包含一个或多个容器，并且这些容器共享相同的网络和存储。通过本节课的学习，你将掌握如何创建和管理 Pod，并进一步理解与 Kubernetes 集群交互的基础模式。

---

## 什么是 Pod？

在 Kubernetes 中，**Pod** 是一个或多个容器的集合。虽然每个 Pod 最小可以包含一个容器，我们的例子中会聚焦于单容器 Pod，但 Kubernetes 同时支持 **多容器 Pod**，它们共享相同的网络空间和存储。

### Pod 的重要特点：

1. **共享网络：** 每个 Pod 都有一个唯一的 IP 地址，不论其容器位于哪个节点。所有 Pod 都可以相互通信，无论它们所在的节点是什么。
2. **资源管理：** Pod 的声明包含容器的所有属性，例如容器镜像、端口映射、自动重启策略、资源限制等。

---

## Pod 的声明与 Manifest 文件

Pod 的配置是通过 **Manifest 文件** 来完成的。Manifest 文件包含了 Kubernetes 资源的描述，包括资源的 **API 版本**、**Kind**（资源类型）、**Metadata**（元数据）和 **Spec**（规格）。

Manifest 文件通常采用 YAML 格式，并被用来定义 Kubernetes 中的各种资源。通过向 Kubernetes API 服务器发送 Manifest 文件，Kubernetes 会根据文件中的描述进行相应的操作，如创建 Pod、服务等。

### 一个简单的 Pod 示例：

以下是一个最简单的 Pod Manifest 示例：

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: my-pod
spec:
  containers:
    - name: nginx-container
      image: nginx:latest
```

- **apiVersion**: Kubernetes API 版本。
- **kind**: 资源类型（这里是 Pod）。
- **metadata**: 资源的元数据，最少需要指定 `name`。
- **spec**: 资源的规格配置，这里定义了容器的名称和镜像。

---

## 使用 `kubectl` 创建和管理 Pod

### 1. 创建 Pod

使用以下命令创建 Pod：

```bash
kubectl create -f pod.yaml
```

其中 `pod.yaml` 是你之前编写的 Manifest 文件。`kubectl create` 命令将读取该文件并根据其中的描述在 Kubernetes 集群中创建相应的资源。

### 2. 查看 Pod 状态

运行以下命令查看当前 Pod 的状态：

```bash
kubectl get pods
```

这会列出当前命名空间中的所有 Pod，包括每个 Pod 的运行状态、重启次数、存活时间等信息。

### 3. 查看 Pod 详细信息

要获取 Pod 的详细信息，可以使用 `describe` 命令：

```bash
kubectl describe pod my-pod
```

这将显示关于 Pod 的详细信息，包括它的 IP 地址、运行状态、容器状态以及容器的日志等。

---

## 配置容器端口和资源请求

### 1. 配置端口映射

在 Pod 的配置中，你可能需要将容器的某个端口暴露到外部网络，以便外部访问容器服务。通过添加端口映射来实现：

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: nginx-pod
spec:
  containers:
    - name: nginx-container
      image: nginx:latest
      ports:
        - containerPort: 80
```

这个配置将在容器中暴露 80 端口，以便访问 Nginx 服务。

### 2. 设置资源请求与限制

Kubernetes 调度 Pod 时，需要考虑其资源请求（CPU 和内存）以及可能的资源限制。你可以为 Pod 配置这些参数：

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: nginx-pod
spec:
  containers:
    - name: nginx-container
      image: nginx:latest
      resources:
        requests:
          memory: "64Mi"
          cpu: "250m"
        limits:
          memory: "128Mi"
          cpu: "500m"
```

- **requests**: 定义 Pod 启动时的资源需求。
- **limits**: 限制 Pod 最大可使用的资源。

---

## 删除 Pod

如果你需要删除一个 Pod，可以使用以下命令：

```bash
kubectl delete pod my-pod
```

该命令将会删除 `my-pod`，并且如果 Pod 被某个控制器（如 Deployment）管理，它会自动创建一个新的 Pod 来替代已删除的 Pod。

---

## 小结

在本节课中，我们学习了 Kubernetes 中 **Pod** 的基本概念及操作：

1. **Pod 是最小的部署单元**，包含一个或多个容器。
2. Pod 的配置通过 **Manifest 文件** 来声明，可以使用 YAML 格式定义。
3. 通过 **`kubectl`** 可以轻松创建、查看和管理 Pod。
4. 我们还学习了如何配置容器的端口映射和资源请求与限制。

接下来，我们将通过 **服务（Service）** 来使我们的 Web 应用可访问，进一步探索如何在 Kubernetes 中构建和管理生产环境应用。
