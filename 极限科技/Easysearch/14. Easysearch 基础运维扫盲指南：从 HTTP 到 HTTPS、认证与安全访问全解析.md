---
title: Easysearch åŸºç¡€è¿ç»´æ‰«ç›²æŒ‡å—ï¼šä» HTTP åˆ° HTTPSã€è®¤è¯ä¸å®‰å…¨è®¿é—®å…¨è§£æ
tags: æœç´¢å¼•æ“ï¼ˆESï¼‰
toc: true
categories: æé™ç§‘æŠ€
abbrlink: 1f7436df
date: 2025-04-23 00:00:00
---

ä¼—æ‰€å‘¨çŸ¥ï¼ŒåŸç”Ÿ Elasticsearch é»˜è®¤å¼€å¯çš„æ˜¯ **HTTP æ˜æ–‡æ¥å£**ï¼Œå¹¶ä¸”ä¸å¼€å¯è®¤è¯æˆ–åŠ å¯†ã€‚å¦‚æœè¦å¯ç”¨ TLS/SSL åŠ å¯†å’Œè´¦å·è®¤è¯ï¼Œé€šå¸¸éœ€è¦é¢å¤–é…ç½®ä¸€ç³»åˆ—å®‰å…¨æ¨¡å—ã€‚

è€Œåœ¨ EasySearch ä¸­ï¼Œå®˜æ–¹é€šè¿‡ `initialize.sh` åˆå§‹åŒ–è„šæœ¬ï¼Œå¤§å¤§ç®€åŒ–äº†è¿™äº›å®‰å…¨é…ç½®ï¼Œ**å¯åŠ¨æ—¶å°±èƒ½è‡ªåŠ¨ç”Ÿæˆè¯ä¹¦å¹¶å¼€å¯å¯†ç ä¿æŠ¤**ã€‚ä¸è¿‡åœ¨ä¸€äº›æµ‹è¯•æˆ–å¼€å‘ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬å¯èƒ½å¸Œæœ›ä¸´æ—¶ä½¿ç”¨ **HTTP + æ— å¯†ç ** çš„ç®€åŒ–æ–¹å¼æ¥è°ƒè¯•ã€‚

æœ¬æ–‡å°†ä»é…ç½®æ–‡ä»¶å…¥æ‰‹ï¼Œé€æ­¥è¯´æ˜å¦‚ä½•å¯ç”¨æˆ–å…³é—­è®¤è¯ã€å¦‚ä½•ä» HTTPS åˆ‡æ¢å› HTTPï¼Œä»¥åŠå¦‚ä½•å¼€æ”¾å¤–ç½‘è®¿é—®ã€‚

## <!-- more -->

## ğŸ›  åˆå§‹åŒ–å¯åŠ¨ä¿¡æ¯ä¸é»˜è®¤å¯†ç 

å½“ä½ æ‰§è¡Œ `bin/initialize.sh` åï¼Œç»ˆç«¯å’Œ `initialize.log` ä¼šè¾“å‡ºåˆå§‹åŒ–ä¿¡æ¯ï¼Œå…¶ä¸­åŒ…æ‹¬è‡ªåŠ¨ç”Ÿæˆçš„ç®¡ç†å‘˜è´¦å·å¯†ç ï¼Œä¾‹å¦‚ï¼š

```bash
curl -ku admin:160824cab0b02193226e https://localhost:9200
```

é»˜è®¤æƒ…å†µä¸‹ï¼ŒæœåŠ¡å·²å¯ç”¨ HTTPS ä¸å¯†ç è®¤è¯ã€‚

---

## âš™ ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼šeasysearch.yml

é…ç½®æ–‡ä»¶ä½äºï¼š

```
config/easysearch.yml
```

å¯ä»¥åœ¨æ­¤æ–‡ä»¶ä¸­è‡ªå®šä¹‰é›†ç¾¤åç§°ï¼š

```yaml
cluster.name: my-application
```

ä¿®æ”¹å‰è®¿é—®æ•ˆæœå¦‚ä¸‹ï¼š

```bash
curl -ku admin:160824cab0b02193226e http://localhost:9200
```

```json
"cluster_name": "easysearch",
```

ä¿®æ”¹åå†æ¬¡è®¿é—®ï¼š

```bash
curl -ku admin:160824cab0b02193226e http://localhost:9200
```

```json
"cluster_name": "my-application",
```

---

## ğŸŒ å¼€æ”¾å¤–ç½‘è®¿é—®ï¼ˆå•èŠ‚ç‚¹éƒ¨ç½²ï¼‰

å¦‚æœä½ å¸Œæœ›è®©å…¶ä»–è®¾å¤‡æˆ–å…¬ç½‘è®¿é—® EasySearchï¼Œå¯ä»¥æ·»åŠ ä»¥ä¸‹å‚æ•°ï¼š

```yaml
network.host: 0.0.0.0
http.port: 9200
discovery.type: single-node
```

æ­¤å¤–ï¼Œä¸ºäº†æé«˜å¯¹ Elasticsearch å®¢æˆ·ç«¯çš„å…¼å®¹æ€§ï¼Œå»ºè®®æ·»åŠ ï¼š

```yaml
elasticsearch.api_compatibility: true
```

---

## ğŸ”’ æ§åˆ¶ HTTPS ä¸å¯†ç è®¤è¯

EasySearch çš„å®‰å…¨é…ç½®ç”±ä»¥ä¸‹ä¸¤ä¸ªæ ¸å¿ƒå‚æ•°æ§åˆ¶ï¼š

| å‚æ•°                        | ä½œç”¨                                  |
| --------------------------- | ------------------------------------- |
| `security.enabled`          | æ˜¯å¦å¯ç”¨è®¤è¯ï¼ˆè´¦å·å¯†ç ï¼‰å’Œ HTTPS æ¨¡å— |
| `security.ssl.http.enabled` | æ˜¯å¦å¯ç”¨ HTTPSï¼ˆSSL/TLS åŠ å¯†ï¼‰        |

### ğŸ” é…ç½®ç»„åˆå«ä¹‰å¦‚ä¸‹ï¼š

| `security.enabled` | `security.ssl.http.enabled` | æ•ˆæœ                                      |
| ------------------ | --------------------------- | ----------------------------------------- |
| true               | true                        | é»˜è®¤é…ç½®ï¼Œå¯ç”¨è®¤è¯ + HTTPSï¼ˆæ¨èï¼‰        |
| true               | false                       | ä»…è®¤è¯ï¼Œæ— åŠ å¯†ï¼Œä½¿ç”¨æ˜æ–‡ HTTP             |
| false              | true                        | æ— è®¤è¯ï¼ŒHTTPS åŠ å¯†ï¼Œä»…é€‚åˆç‰¹æ®Šç”¨é€”        |
| false              | false                       | æœ€å¼€æ”¾ï¼ŒHTTP + æ— å¯†ç ï¼Œ**ä¸æ¨èç”Ÿäº§ä½¿ç”¨** |

ä½ å¯ä»¥æ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©æ˜¯å¦æ‰“å¼€åŠ å¯†æˆ–è®¤è¯ï¼Œé€‚é…æµ‹è¯•ä¸ç”Ÿäº§ç¯å¢ƒã€‚

---

## ğŸ“¸ ç¤ºä¾‹ï¼šå¯ç”¨ HTTP ä¸”å¼€å¯è®¤è¯

å¦‚æœä½ ä¿®æ”¹é…ç½®ä¸º `security.ssl.http.enabled: false`ï¼Œå³å¯ä½¿ç”¨ HTTPï¼Œä½†ä»è¦æ±‚è¾“å…¥ç”¨æˆ·åå¯†ç è¿›è¡Œè®¿é—®ï¼š

```yaml
security.enabled: true
security.ssl.http.enabled: false
```

è®¿é—®æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![image-20250425120123219](https://raw.githubusercontent.com/cloudsmithy/picgo-imh/master/image-20250425120123219.png)

---

## âœ… å°ç»“

| åœºæ™¯                       | æ¨èé…ç½®                                                       |
| -------------------------- | -------------------------------------------------------------- |
| æœ¬åœ°æµ‹è¯•ï¼ˆä¸åŠ å¯†ã€æ— å¯†ç ï¼‰ | `security.enabled: false` + `security.ssl.http.enabled: false` |
| æœ¬åœ°æµ‹è¯•ï¼ˆä»…åŠ è®¤è¯ï¼‰       | `security.enabled: true` + `security.ssl.http.enabled: false`  |
| å®‰å…¨è®¿é—®ï¼ˆé»˜è®¤ï¼‰           | `security.enabled: true` + `security.ssl.http.enabled: true`   |
| HTTPS ä¸è®¤è¯               | `security.enabled: false` + `security.ssl.http.enabled: true`  |

EasySearch æä¾›äº†çµæ´»çš„é…ç½®æ–¹å¼ï¼Œé€‚åˆä¸åŒåœºæ™¯è‡ªç”±åˆ‡æ¢ã€‚å¯¹äºå¼€å‘è€…æ¥è¯´ï¼Œç†è§£è¿™ä¸¤ä¸ªå‚æ•°çš„ä½œç”¨ï¼Œæ˜¯å¿«é€Ÿä¸Šæ‰‹è¿ç»´çš„ç¬¬ä¸€æ­¥ã€‚

æåˆ°è®¤è¯,æˆ‘ä»¬å†çœ‹çœ‹å¦‚ä½•ä¿®æ”¹å¯†ç ,ç”±äº Easysearch é»˜è®¤æ–°å»ºäº†ä¸€ä¸ª admin çš„ç”¨æˆ·,å¹¶ä¸”å­˜åœ¨ config/security/user.yml ä¸‹

```
---
# This is the internal user database create by initialize
# The hash value is a bcrypt hash and can be generated with hash_password.sh

_meta:
  type: "user"
  config_version: 2

# Define your internal users here

## Demo users
admin:
  hash: "$2y$12$rmNDJxpQdRDb3F1dqk.uweSZqH3VAqeEpkP298vJ6QS99K80kbRoO"
  reserved: true
  external_roles:
    - "admin"
  description: "Admin user"

```

è¿™ä¸ªæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ postman å¼€è°ƒç”¨ API.http://localhost:9200/\_security/account

![image-20250425124456187](https://raw.githubusercontent.com/cloudsmithy/picgo-imh/master/image-20250425124456187.png)

```python
import requests

url = "http://192.168.5.8:9200"

payload = {}
headers = {
  'Authorization': 'Basic YWRtaW46MTYwODI0Y2FiMGIwMjE5MzIyNmU='
}

response = requests.request("GET", url, headers=headers, data=payload)

print(response.text)

```

æ–°å»ºç”¨æˆ·

![](https://raw.githubusercontent.com/cloudsmithy/picgo-imh/master/image-20250425153652216.png)

æŸ¥çœ‹æ¥å£:https://localhost:9200/\_security/user

ä¸è¿‡ yml æ–‡ä»¶è¿˜æ˜¯åªæœ‰ admin,ç”¨ api æŸ¥çœ‹

![image-20250425153959573](https://raw.githubusercontent.com/cloudsmithy/picgo-imh/master/image-20250425153959573.png)

ä½¿ç”¨æ–°ç”¨æˆ·æµ‹è¯•å¯ä»¥è®¿é—®:

![image-20250425153643049](https://raw.githubusercontent.com/cloudsmithy/picgo-imh/master/image-20250425153643049.png)

mysql -P 3306 -u admin -p -h mysqlsource.crtihcoeqzab.us-west-2.rds.amazonaws.com < people.sql

mysql -P 3306 -u admin -p -h mysqlsource.crtihcoeqzab.us-west-2.rds.amazonaws.com people

psql -h cloudacademylabs-targetcluster-0zdokkxbiyyh.cluster-ro-crtihcoeqzab.us-west-2.rds.amazonaws.com -U postgres -p 5432 people
