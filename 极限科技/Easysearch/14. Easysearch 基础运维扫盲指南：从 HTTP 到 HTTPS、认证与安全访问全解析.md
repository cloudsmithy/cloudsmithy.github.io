---
title: Easysearch åŸºç¡€è¿ç»´æ‰«ç›²æŒ‡å—ï¼šä» HTTP åˆ° HTTPSã€è®¤è¯ä¸å®‰å…¨è®¿é—®å…¨è§£æ
tags: æœç´¢å¼•æ“ï¼ˆESï¼‰
toc: true
categories: æé™ç§‘æŠ€
date: 2025-07-02 00:00:00
---

ä¼—æ‰€å‘¨çŸ¥ï¼ŒåŸç”Ÿ Elasticsearch é»˜è®¤å¼€å¯çš„æ˜¯ **HTTP æ˜æ–‡æ¥å£**ï¼Œå¹¶ä¸”ä¸å¼€å¯ä»»ä½•èº«ä»½è®¤è¯æˆ–ä¼ è¾“åŠ å¯†ã€‚è‹¥æƒ³å¯ç”¨ TLS/SSL åŠ å¯†åŠè´¦å·å¯†ç éªŒè¯ï¼Œé€šå¸¸éœ€è¦é…ç½®ç¹ççš„å®‰å…¨æ¨¡å—ã€‚

è€Œ Easysearch åœ¨æ­¤åŸºç¡€ä¸Šåšäº†æå¤§çš„ç®€åŒ–ï¼Œé€šè¿‡å®˜æ–¹æä¾›çš„ `initialize.sh` è„šæœ¬ï¼Œä¸€é”®å®Œæˆåˆå§‹åŒ–å³å¯è‡ªåŠ¨ç”Ÿæˆè¯ä¹¦ã€é…ç½® HTTPSï¼Œå¹¶å¯ç”¨å¯†ç è®¤è¯ã€‚

å½“ç„¶ï¼Œå¯¹äºæœ¬åœ°å¼€å‘æˆ–ä¸´æ—¶æµ‹è¯•åœºæ™¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯èƒ½å¸Œæœ›å…³é—­ HTTPS ä¸è®¤è¯ï¼Œç›´æ¥é€šè¿‡ HTTP è°ƒè¯•æœåŠ¡ã€‚æœ¬æ–‡å°†ä»é…ç½®æ–‡ä»¶å‡ºå‘ï¼Œé€æ­¥è®²è§£å¦‚ä½•æ ¹æ®ä¸åŒéœ€æ±‚é…ç½® Easysearch çš„å®‰å…¨ç­–ç•¥ã€é€šä¿¡åè®®ä¸å¤–ç½‘è®¿é—®æƒé™ã€‚

---

## ğŸ›  ä¸€ã€åˆå§‹åŒ–è¾“å‡ºä¸é»˜è®¤è´¦å·å¯†ç 

æ‰§è¡Œä»¥ä¸‹åˆå§‹åŒ–å‘½ä»¤åï¼š

```bash
bin/initialize.sh
```

ç»ˆç«¯åŠ `initialize.log` æ–‡ä»¶ä¸­å°†è¾“å‡ºåˆå§‹çš„è®¿é—®æ–¹å¼å’Œç®¡ç†å‘˜è´¦å·å¯†ç ï¼Œä¾‹å¦‚ï¼š

```bash
curl -ku admin:160824cab0b02193226e https://localhost:9200
```

é»˜è®¤æƒ…å†µä¸‹ï¼ŒEasysearch å¯ç”¨äº† HTTPS é€šä¿¡åŠå¯†ç è®¤è¯ã€‚

---

## âš™ äºŒã€ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š`easysearch.yml`

é…ç½®æ–‡ä»¶è·¯å¾„ï¼š

```
config/easysearch.yml
```

ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä¿®æ”¹é›†ç¾¤åç§°ï¼š

```yaml
cluster.name: my-application
```

ä¿®æ”¹å‰è®¿é—®è¾“å‡ºï¼š

```bash
"cluster_name": "easysearch"
```

ä¿®æ”¹åï¼š

```bash
"cluster_name": "my-application"
```

---

## ğŸŒ ä¸‰ã€å¼€æ”¾å¤–ç½‘è®¿é—®ï¼ˆå•èŠ‚ç‚¹éƒ¨ç½²ï¼‰

è‹¥å¸Œæœ›åœ¨å±€åŸŸç½‘æˆ–å…¬ç½‘è®¿é—® Easysearchï¼Œå¯ä»¥åŠ å…¥ä»¥ä¸‹é…ç½®ï¼š

```yaml
network.host: 0.0.0.0
http.port: 9200
discovery.type: single-node
```

æ­¤å¤–ï¼Œä¸ºå¢å¼ºå¯¹åŸç”Ÿ Elasticsearch å®¢æˆ·ç«¯çš„å…¼å®¹æ€§ï¼Œå»ºè®®æ·»åŠ ï¼š

```yaml
elasticsearch.api_compatibility: true
```

---

## ğŸ” å››ã€æ§åˆ¶ HTTPS ä¸è®¤è¯åŠŸèƒ½å¼€å…³

Easysearch æä¾›ä¸¤ä¸ªæ ¸å¿ƒå‚æ•°æ§åˆ¶å®‰å…¨è¡Œä¸ºï¼š

| å‚æ•°                        | è¯´æ˜                           |
| --------------------------- | ------------------------------ |
| `security.enabled`          | æ§åˆ¶æ˜¯å¦å¯ç”¨èº«ä»½è®¤è¯å’Œå®‰å…¨æ¨¡å— |
| `security.ssl.http.enabled` | æ§åˆ¶æ˜¯å¦å¯ç”¨ HTTPSï¼ˆSSL/TLSï¼‰  |

ä½ å¯ä»¥æ ¹æ®ç¯å¢ƒé€‰æ‹©é…ç½®ç»„åˆï¼š

| `security.enabled` | `security.ssl.http.enabled` | æ•ˆæœ                                         |
| ------------------ | --------------------------- | -------------------------------------------- |
| true               | true                        | é»˜è®¤é…ç½®ï¼Œå¯ç”¨ HTTPS å’Œè®¤è¯ï¼ˆæ¨èï¼‰          |
| true               | false                       | æ˜æ–‡ HTTP + å¯ç”¨è®¤è¯                         |
| false              | true                        | å¯ç”¨åŠ å¯†ä½†æ— èº«ä»½è®¤è¯ï¼ˆä¸å¸¸è§ï¼‰               |
| false              | false                       | å®Œå…¨å¼€æ”¾ï¼Œæ— è®¤è¯ + HTTPï¼ˆâš ï¸ ä¸å»ºè®®ç”Ÿäº§ä½¿ç”¨ï¼‰ |

---

## ğŸ“¸ äº”ã€ç¤ºä¾‹ï¼šå¯ç”¨ HTTP å¹¶ä¿ç•™è®¤è¯

å¦‚æœä½ å¸Œæœ›ä½¿ç”¨ HTTP è€Œä¸å¯ç”¨ HTTPSï¼Œå¯ä¿®æ”¹å¦‚ä¸‹é…ç½®ï¼š

```yaml
security.enabled: true
security.ssl.http.enabled: false
```

è®¿é—®æ—¶ä¾ç„¶éœ€è¦æä¾›è´¦å·å¯†ç ï¼Œæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![image-20250425120123219](https://i-blog.csdnimg.cn/img_convert/64574ba1495c4560638d9446f7a098d5.png)

---

## ğŸ”§ å…­ã€ç”¨æˆ·è®¤è¯ä¸å¯†ç ç®¡ç†

åˆå§‹åŒ–å®Œæˆåï¼ŒEasysearch é»˜è®¤ä¼šåˆ›å»ºä¸€ä¸ªç®¡ç†å‘˜ç”¨æˆ· `admin`ï¼Œå…¶ä¿¡æ¯å­˜å‚¨åœ¨ï¼š

```
config/security/user.yml
```

ç¤ºä¾‹å¦‚ä¸‹ï¼š

```yaml
admin:
  hash: "$2y$12$rmNDJxpQdRDb3F1dqk.uweSZqH3VAqeEpkP298vJ6QS99K80kbRoO"
  reserved: true
  external_roles:
    - "admin"
  description: "Admin user"
```

ä½ å¯ä»¥ä½¿ç”¨ Postman æˆ– Python è„šæœ¬éªŒè¯è®¿é—®ï¼š

```python
import requests

url = "http://localhost:9200"
headers = {
  'Authorization': 'Basic YWRtaW46MTYwODI0Y2FiMGIwMjE5MzIyNmU='
}
response = requests.get(url, headers=headers)
print(response.text)
```

---

## ğŸ‘¤ ä¸ƒã€æ–°å»ºç”¨æˆ·ä¸ç®¡ç†æ¥å£

ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ¥å£æŸ¥è¯¢å½“å‰ç”¨æˆ·ä¿¡æ¯ï¼š

```
GET /_security/account
```

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/e14fbb45263c444283c1c4164a72d5f9.png)

ä¹Ÿå¯ä»¥è®¿é—®ï¼š

```
GET /_security/user
```

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/97b5fd272c2c4385b4f38b3aa216f639.png)

ç”¨äºåˆ—å‡ºæ‰€æœ‰ç”¨æˆ·ã€‚

è™½ç„¶ `user.yml` æ–‡ä»¶é»˜è®¤åªåŒ…å« `admin` ç”¨æˆ·ï¼Œä½†é€šè¿‡ API æ·»åŠ çš„æ–°ç”¨æˆ·åŒæ ·ç”Ÿæ•ˆã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œé€šè¿‡ Postman åˆ›å»ºçš„æ–°ç”¨æˆ·å·²æˆåŠŸç”Ÿæ•ˆï¼š

- æ–°ç”¨æˆ·åˆ›å»ºç•Œé¢ï¼š

  ![æ–°å»ºç”¨æˆ·](https://i-blog.csdnimg.cn/img_convert/228aa37c447c7b5ad2ffcdab0c3dfc23.png)

- ä½¿ç”¨æ–°ç”¨æˆ·è®¿é—®éªŒè¯æˆåŠŸï¼š

  ![æ–°ç”¨æˆ·è®¿é—®](https://i-blog.csdnimg.cn/img_convert/62096597764fad4ad7c6f14dbd9fb3f8.png)

---

## âœ… æ€»ç»“

| åœºæ™¯                       | æ¨èé…ç½®                                                       |
| -------------------------- | -------------------------------------------------------------- |
| æœ¬åœ°æµ‹è¯•ï¼ˆæ— åŠ å¯†ã€æ— è®¤è¯ï¼‰ | `security.enabled: false` + `security.ssl.http.enabled: false` |
| æœ¬åœ°è°ƒè¯•ï¼ˆåŠ è®¤è¯ã€æ— åŠ å¯†ï¼‰ | `security.enabled: true` + `security.ssl.http.enabled: false`  |
| ç”Ÿäº§ç¯å¢ƒï¼ˆå®‰å…¨é€šä¿¡ï¼‰       | `security.enabled: true` + `security.ssl.http.enabled: true`   |
| ç‰¹æ®Šç”¨é€”ï¼ˆåŠ å¯†ä½†æ— è®¤è¯ï¼‰   | `security.enabled: false` + `security.ssl.http.enabled: true`  |

EasySearch æä¾›äº†éå¸¸çµæ´»çš„é…ç½®æœºåˆ¶ï¼Œå¼€å‘è€…å¯ä»¥æ ¹æ®å…·ä½“éœ€æ±‚ï¼Œè‡ªç”±åˆ‡æ¢ HTTP/HTTPSã€å¼€å¯æˆ–å…³é—­è®¤è¯æ¨¡å—ã€‚ç†è§£å¹¶æŒæ¡è¿™ä¸¤ä¸ªæ ¸å¿ƒå®‰å…¨å‚æ•°ï¼Œå°†å¤§å¤§æå‡ä½ å¯¹ EasySearch çš„è¿ç»´æŒæ§åŠ›ã€‚

## ğŸ” é™„å½•ï¼šå…³äº Basic Auth çš„åŸç†ä¸ä½¿ç”¨æ–¹å¼

åœ¨ Easysearch é»˜è®¤å¼€å¯è®¤è¯çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åœ¨è¯·æ±‚ä¸­ç»å¸¸ä¼šçœ‹åˆ°å¦‚ä¸‹çš„ `Authorization` å¤´ï¼š

```http
Authorization: Basic YWRtaW46MTYwODI0Y2FiMGIwMjE5MzIyNmU=
```

è¿™å…¶å®å°±æ˜¯æ ‡å‡†çš„ **HTTP Basic è®¤è¯**ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š

```
Authorization: Basic <Base64 ç¼–ç åçš„ ç”¨æˆ·å:å¯†ç >
```

---

### ğŸ§  ä¸¾ä¸ªä¾‹å­ï¼š

Base64 ç¼–ç å‰æ˜¯ï¼š

```
admin:160824cab0b02193226e
```

ç¼–ç åå˜æˆï¼š

```
YWRtaW46MTYwODI0Y2FiMGIwMjE5MzIyNmU=
```

ä¹Ÿå°±æ˜¯è¯´ï¼Œä»¥ä¸‹è¯·æ±‚ï¼š

```python
headers = {
  'Authorization': 'Basic YWRtaW46MTYwODI0Y2FiMGIwMjE5MzIyNmU='
}
```

ç­‰ä»·äºï¼š

```bash
curl -u admin:160824cab0b02193226e http://localhost:9200
```

---

### âš ï¸ å®‰å…¨æç¤ºï¼š

> Base64 åªæ˜¯ç¼–ç  **ä¸æ˜¯åŠ å¯†**ï¼Œè´¦å·å¯†ç ä¾ç„¶æ˜¯æ˜æ–‡å½¢å¼ï¼Œå› æ­¤ **å¿…é¡»é…åˆ HTTPS ä½¿ç”¨**ï¼Œå¦åˆ™å®¹æ˜“è¢«ä¸­é—´äººç›‘å¬ã€‚

---

## ğŸŒ ä½¿ç”¨ URL æºå¸¦ç”¨æˆ·åå¯†ç ï¼ˆä¸æ¨èä½†æœ‰æ—¶æ–¹ä¾¿ï¼‰

é™¤äº† Header æˆ– `curl -u` çš„æ–¹å¼ï¼ŒHTTP åè®®è¿˜å…è®¸é€šè¿‡ URL æºå¸¦è´¦å·å¯†ç ï¼š

```bash
curl http://admin:160824cab0b02193226e@localhost:9200
```

æµè§ˆå™¨ä¸­ä¹Ÿå¯ä»¥ç›´æ¥è®¿é—®ï¼š

```
http://admin:160824cab0b02193226e@localhost:9200
```
